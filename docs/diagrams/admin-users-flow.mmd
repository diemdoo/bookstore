%%{init: {'theme':'base', 'themeVariables': { 'primaryColor':'#6366f1'}}}%%
flowchart TD
    Start([Users Management]) --> SelectType{Select Type}
    
    %% Customer Management
    SelectType -->|Customers| ListCustomers[GET /api/admin/users?role=customer<br/>Display customer list]
    ListCustomers --> CustomerAction{Action}
    
    CustomerAction -->|Add Customer| AddCustForm[Fill Customer Form:<br/>- Username<br/>- Email<br/>- Password<br/>- Full Name]
    AddCustForm --> ValidateCust{Valid?}
    ValidateCust -->|No| ShowError1[Show Errors]
    ShowError1 --> AddCustForm
    
    ValidateCust -->|Yes| CreateCust[POST /api/register<br/>role=customer]
    CreateCust --> GenCustCode[Auto-generate<br/>customer_code: KH001, KH002...]
    GenCustCode --> InsertCust[INSERT INTO users]
    InsertCust --> SuccessCust[Show Success Toast]
    SuccessCust --> ListCustomers
    
    CustomerAction -->|Toggle Status| ToggleCustStatus[PUT /api/admin/users/:id/status]
    ToggleCustStatus --> UpdateCustActive[UPDATE users<br/>SET is_active = NOT is_active]
    UpdateCustActive --> ListCustomers
    
    CustomerAction -->|View Details| ViewCust[Display customer info<br/>& order history]
    ViewCust --> ListCustomers
    
    CustomerAction -->|Back| SelectType
    
    SelectType -->|Back to Dashboard| Back([Return to Dashboard])
    
    style Start fill:#e1f5e1
    style Back fill:#ffe1e1
    style SelectType fill:#f0e1ff
    style ValidateCust fill:#fff4e1
    style SuccessCust fill:#d1fae5
    style GenCustCode fill:#fef3c7

